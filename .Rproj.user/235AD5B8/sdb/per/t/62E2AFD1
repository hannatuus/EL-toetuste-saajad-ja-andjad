{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Read.me: saadud ja välja antud EL toetuste analüüs\"\nauthor: \"Hanna Tuus\"\ndate: \"28 juuni 2016\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n## Analüüs\n\nKasutatud on andmekogumit \"Euroopa Liidu struktuuritoetus\" Avaandmete portaalist https://opendata.riik.ee/dataset/euroopa-liidu-struktuuritoetus. \n\nEsiteks on andmed grupeeritud toetuseandjate kaupa ning kõik ühest asutusest välja antud toetused kokku liidetud. Seejärel on andmed grupeeritud toetusesaajate kaupa ning kõik ühele asutusele antud toetused kokku liidetud. Tabelites on kahanevas järjekorrastoodud kuus suurima kogusummaga toetusesaajat ning -andjat.\n\nSeejärel on näha graafikud, kus on välja toodud välja antud summa iga toetuseandja kohta ning kümne suurima toetusesaaja kokku saadud summa. \n\n```{r echo=FALSE,warning=FALSE,message=FALSE}\n#install.packages(\"ggplot2\")\nlibrary(ggplot2)\n#install.packages(\"devtools\")\nlibrary(\"devtools\")\n#install_github(\"RRisto/riigiteenused\")\nlibrary(riigiteenused)\n#install.packages(\"rjson\")\nlibrary(rjson)\nx=andmedSisse(\"https://www.riigiteenused.ee/api/et/all\")\n\n#install.packages(\"dplyr\")\nlibrary(\"dplyr\")\n\n#install.packages(\"reshape2\")\nlibrary(reshape2)\ntoetus = read.csv2(\"./Data/toetuse_saajad.csv\")\n\nlibrary(knitr)\n\nnames(toetus)<-tolower(names(toetus))\n#Vaiketahtedeks\ntoetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)\n#Factor <- numeric\n\nsumma_antud<-toetus%>%\n  group_by(toetuse_andja)%>%\n  summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))\n\nsumma_saadud<-toetus%>%\n  group_by(toetuse_saaja_registri_kood)%>%\n  summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))\n\nsumma_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]\nsumma_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]\n#Jarjestab saadud summad kahanevalt\n\nsumma_antud_long<- melt(summa_antud, id.vars=c(\"toetuse_andja\"))\nsumma_saadud_long<- melt(summa_saadud, id.vars=c(\"toetuse_saaja_registri_kood\"))\n#Convertib data formaadi laiast pikaks\n\nsumma_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]\nsumma_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]\n#Jarjestab summad kahanevalt\n\nsumma_antud_long$value_miljonites<- summa_antud_long$value/1000000\n# Kogusumma iga toetuseandja kohta miljonites\nsumma_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000\n# Kogusumma iga toetusesaaja kohta tuhandetess\n\nkumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]\n#Valib 10 suurimat toetusesaajat\n\nkable (head(summa_saadud))\nkable(head(summa_antud))\n\nggplot(data=summa_antud_long,aes(x= reorder(toetuse_andja, -value), y=value/1000000))+ \n  geom_bar(stat=\"identity\")+ xlab(\"Toetuse andja\")+ ylab(\"Toetuste kogusumma (miljonites)\")+\n  ggtitle(\"Kogusumma iga toetuseandja kohta\")+  \n  theme(axis.text.x=element_text(angle=90), complete=FALSE)\n#Barplot \"Kogusumma iga toetuseandja kohta\", pooratud axis text x-teljel\n\nggplot(data=kumme_suurimat_toetuse_saajat, aes(x= reorder (toetuse_saaja_registri_kood,-value/1000), y=value/10000)) + \n  geom_bar(stat=\"identity\")+ xlab(\"Toetuse saaja registrikood\") +\n  ylab(\"Toetuste kogusumma (tuhandetes)\") + ggtitle(\"Kümme suurimat toetusesaajat\")+\n  theme(axis.text.x=element_text(angle=90), complete=FALSE)\n#Barplot 10 suurima toetusesaaja kogusmma kohta, pooratud axis x-teljel\n\n\n```\n\n\n\nNote that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.\n",
    "created" : 1467029023006.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2526291021",
    "id" : "62E2AFD1",
    "lastKnownWriteTime" : 1467111156,
    "last_content_update" : 1467111156853,
    "path" : "~/Riigiteenused/EL-toetuste-saajad-ja-andjad/readme.Rmd",
    "project_path" : "readme.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}