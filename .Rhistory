group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
10suurimat_toetuse_saajat <- summa_saadud_long[10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=10suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("Kogusumma iga toetusesaaja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("Kogusumma iga toetusesaaja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(kumme_suurimat_toetuse_saajat)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=summa_antud_long[1:10,], aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("Kogusumma iga toetusesaaja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(kumme_suurimat_toetuse_saajat)
View(kumme_suurimat_toetuse_saajat)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=kumme_suurimat_toetuse_saajat,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=summa_antud_long[1:10,], aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("Kogusumma iga toetusesaaja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(kumme_suurimat_toetuse_saajat)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=toetuse_andja_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("Kogusumma iga toetusesaaja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=toetuse_andja_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=toetus_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=toetus_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(summa_antud_long)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=toetus_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
save.image("~/Riigiteenused/tegin markdowni jaoks faili.RData")
#install.packages("ggplot2")
library(ggplot2)
#install.packages("devtools")
library("devtools")
#install_github("RRisto/riigiteenused")
library(riigiteenused)
#install.packages("rjson")
library(rjson)
x=andmedSisse("https://www.riigiteenused.ee/api/et/all")
#install.packages("dplyr")
library("dplyr")
#install.packages("reshape2")
library(reshape2)
toetus = read.csv2("./Data/toetuse_saajad.csv")
---
title: "Read.me: saadud ja vÃ¤lja antud EL toetuste analÃ¼Ã¼s"
author: "Hanna Tuus"
date: "22 juuni 2016"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## AnalÃ¼Ã¼s
Kasutatud on neid andmeid nendest kohtadest... Esiteks on andmed grupeeritud toetuseandjate kaupa ning kÃµik Ã¼hest asutusest vÃ¤lja antud toetused kokku liidetud. SeejÃ¤rel on andmed grupeeritud toetusesaajate kaupa ning kÃµik Ã¼hele asutusele antud toetused kokku liidetud.
```{r echo=FALSE}
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
head(summa_antud)
head(summa_saadud)
```
## Including Plots
You can also embed plots, for example:
```{r pressure, echo=FALSE}
plot(pressure)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(summa_antud_long)
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
View(summa_antud_long)
View(summa_saadud_long)
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
View(summa_saadud_long)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(summa_saadud_long)
View(summa_antud_long)
library(ggplot2)
#install.packages("devtools")
library("devtools")
#install_github("RRisto/riigiteenused")
library(riigiteenused)
#install.packages("rjson")
library(rjson)
x=andmedSisse("https://www.riigiteenused.ee/api/et/all")
#install.packages("dplyr")
library("dplyr")
library(reshape2)
toetus = read.csv2("./Data/toetuse_saajad.csv")
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
#
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
View(summa_antud_long)
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
head(summa_antud)
head(summa_saadud)
#install.packages("ggplot2")
library(ggplot2)
#install.packages("devtools")
library("devtools")
#install_github("RRisto/riigiteenused")
library(riigiteenused)
#install.packages("rjson")
library(rjson)
x=andmedSisse("https://www.riigiteenused.ee/api/et/all")
#install.packages("dplyr")
library("dplyr")
#install.packages("reshape2")
library(reshape2)
toetus = read.csv2("./Data/toetuse_saajad.csv")
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
---
title: "Read.me: saadud ja vÃ¤lja antud EL toetuste analÃ¼Ã¼s"
author: "Hanna Tuus"
date: "22 juuni 2016"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## AnalÃ¼Ã¼s
Kasutatud on neid andmeid nendest kohtadest... Esiteks on andmed grupeeritud toetuseandjate kaupa ning kÃµik Ã¼hest asutusest vÃ¤lja antud toetused kokku liidetud. SeejÃ¤rel on andmed grupeeritud toetusesaajate kaupa ning kÃµik Ã¼hele asutusele antud toetused kokku liidetud.
```{r echo=FALSE}
#install.packages("ggplot2")
library(ggplot2)
#install.packages("devtools")
library("devtools")
#install_github("RRisto/riigiteenused")
library(riigiteenused)
#install.packages("rjson")
library(rjson)
x=andmedSisse("https://www.riigiteenused.ee/api/et/all")
#install.packages("dplyr")
library("dplyr")
#install.packages("reshape2")
library(reshape2)
toetus = read.csv2("./Data/toetuse_saajad.csv")
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetes
head(summa_antud)
head(summa_saadud)
summa_saadud_long$value <- sort(summa_saadud_long$value, decreasing=TRUE)
#Jarjestab saadud summa kahanevalt
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("KÃ¼mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
