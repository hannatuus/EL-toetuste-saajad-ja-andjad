View(summa_antud)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud$summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud$summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
View(summa_saadud)
View(summa_antud)
View(summa_saadud)
View(summa_antud)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
View(summa_saadud)
View(summa_antud)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=reorder(toetuse_andja,-value),y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(summa_saadud)
View(summa_antud)
View(kumme_suurimat_toetuse_saajat)
View(summa_saadud)
View(summa_antud_long)
View(summa_saadud_long)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=reorder(toetuse_andja,-value),y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(kumme_suurimat_toetuse_saajat)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,-value,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(summa_antud)
View(summa_saadud)
View(summa_antud_long)
View(summa_saadud_long)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,-value,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(kumme_suurimat_toetuse_saajat)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
summa_antud_long <- factor(summa_antud_long, lebels = summa_antud_long[order(x$value)])
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
summa_antud_long <- factor(summa_antud_long, levels = summa_antud_long[order(x$value)])
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
View(summa_antud_long)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
summa_antud_long <- factor(summa_antud_long$toetuse_andja, +
levels = summa_antud_long[order(x$value)])
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
summa_antud_long <- factor(summa_antud_long$toetuse_andja, levels = summa_antud_long[order(x$value)])
ggplot(data=summa_antud_long,aes(x=toetuse_andja,y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x= reorder(toetuse_andja, -value), y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x=toetuse_saaja_registri_kood, y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x= reorder(toetuse_andja, -value), y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x= reorder (toetuse_saaja_registri_kood,value/1000), y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
ggplot(data=summa_antud_long,aes(x= reorder(toetuse_andja, -value), y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x= reorder (toetuse_saaja_registri_kood,-value/1000), y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
---
title: "Read.me: saadud ja v辰lja antud EL toetuste anal端端s"
author: "Hanna Tuus"
date: "28 juuni 2016"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Anal端端s
Kasutatud on andmekogumit "Euroopa Liidu struktuuritoetus" Avaandmete portaalist https://opendata.riik.ee/dataset/euroopa-liidu-struktuuritoetus.
Esiteks on andmed grupeeritud toetuseandjate kaupa ning k探ik 端hest asutusest v辰lja antud toetused kokku liidetud. Seej辰rel on andmed grupeeritud toetusesaajate kaupa ning k探ik 端hele asutusele antud toetused kokku liidetud. Tabelites on toodud kuus suurima kogusummaga toetusesaajat ning -andjat.
Seej辰rel on n辰ha graafikud, kus on v辰lja toodud v辰lja antud summa iga toetuseandja kohta ning k端mne suurima toetusesaaja kokku saadud summa.
```{r echo=FALSE,warning=FALSE,message=FALSE}
#install.packages("ggplot2")
library(ggplot2)
#install.packages("devtools")
library("devtools")
#install_github("RRisto/riigiteenused")
library(riigiteenused)
#install.packages("rjson")
library(rjson)
x=andmedSisse("https://www.riigiteenused.ee/api/et/all")
#install.packages("dplyr")
library("dplyr")
#install.packages("reshape2")
library(reshape2)
toetus = read.csv2("./Data/toetuse_saajad.csv")
library(knitr)
names(toetus)<-tolower(names(toetus))
#Vaiketahtedeks
toetus$projekti_toetus<-as.numeric(toetus$projekti_toetus)
#Factor <- numeric
summa_antud<-toetus%>%
group_by(toetuse_andja)%>%
summarise(summa_antud = sum(projekti_toetus, na.rm=TRUE))
summa_saadud<-toetus%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa_saadud = sum(projekti_toetus, na.rm=TRUE))
summa_antud<-summa_antud[order(summa_antud$summa_antud, decreasing=TRUE),]
summa_saadud<-summa_saadud[order(summa_saadud$summa_saadud, decreasing=TRUE),]
#Jarjestab saadud summad kahanevalt
summa_antud_long<- melt(summa_antud, id.vars=c("toetuse_andja"))
summa_saadud_long<- melt(summa_saadud, id.vars=c("toetuse_saaja_registri_kood"))
#Convertib data formaadi laiast pikaks
summa_antud_long<- summa_antud_long[order(summa_antud_long$value, decreasing=T),]
summa_saadud_long<- summa_saadud_long[order(summa_saadud_long$value, decreasing=T),]
#Jarjestab summad kahanevalt
summa_antud_long$value_miljonites<- summa_antud_long$value/1000000
# Kogusumma iga toetuseandja kohta miljonites
summa_saadud_long$value_tuhandetes<-summa_saadud_long$value / 10000
# Kogusumma iga toetusesaaja kohta tuhandetess
kumme_suurimat_toetuse_saajat <- summa_saadud_long[1:10,]
#Valib 10 suurimat toetusesaajat
kable (head(kumme_suurimat_toetuse_saajat))
kable(head(summa_antud))
ggplot(data=summa_antud_long,aes(x= reorder(toetuse_andja, -value), y=value/1000000))+
geom_bar(stat="identity")+ xlab("Toetuse andja")+ ylab("Toetuste kogusumma (miljonites)")+
ggtitle("Kogusumma iga toetuseandja kohta")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot "Kogusumma iga toetuseandja kohta", pooratud axis text x-teljel
ggplot(data=kumme_suurimat_toetuse_saajat, aes(x= reorder (toetuse_saaja_registri_kood,-value/1000), y=value/10000)) +
geom_bar(stat="identity")+ xlab("Toetuse saaja registrikood") +
ylab("Toetuste kogusumma (tuhandetes)") + ggtitle("K端mme suurimat toetusesaajat")+
theme(axis.text.x=element_text(angle=90), complete=FALSE)
#Barplot 10 suurima toetusesaaja kogusmma kohta, pooratud axis x-teljel
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
